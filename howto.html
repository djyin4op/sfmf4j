<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Mar 6, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Steven Swor" />
    <meta name="Date-Creation-yyyymmdd" content="20130304" />
    <meta name="Date-Revision-yyyymmdd" content="20130306" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SFMF4J: Simple File Monitor Facade For Java - Howto</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">SFMF4J <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="About">About</a>
</li>
                  
                      <li>      <a href="howto.html"  title="Howto">Howto</a>
</li>
                  
                      <li>      <a href="implementation-features.html"  title="Implementation Features">Implementation Features</a>
</li>
                  
                      <li>      <a href="architecture.html"  title="Architecture">Architecture</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="sfmf4j-api/index.html"  title="SFMF4J :: API">SFMF4J :: API</a>
</li>
                  
                      <li>      <a href="sfmf4j-commonsio/index.html"  title="SFMF4J :: Commons IO">SFMF4J :: Commons IO</a>
</li>
                  
                      <li>      <a href="sfmf4j-jpathwatch/index.html"  title="SFMF4J :: JPathWatch">SFMF4J :: JPathWatch</a>
</li>
                  
                      <li>      <a href="sfmf4j-nio2/index.html"  title="SFMF4J :: NIO2">SFMF4J :: NIO2</a>
</li>
                  
                      <li>      <a href="sfmf4j-tests/index.html"  title="SFMF4J :: Test Classes">SFMF4J :: Test Classes</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                                  <li>      <a href="modules.html"  title="Project Modules">Project Modules</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="dependency-management.html"  title="Dependency Management">Dependency Management</a>
</li>
                                  <li>      <a href="plugin-management.html"  title="Plugin Management">Plugin Management</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD Report">PMD Report</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD Report">CPD Report</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                                              
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>SFMF4J: Simple File Monitor Facade For Java</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="index.html" title="SFMF4J: Simple File Monitor Facade For Java">
        SFMF4J: Simple File Monitor Facade For Java</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Howto</li>
        
                
                    
                 <li id="projectVersion" class="pull-right">Version: 1.0</li>
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <div class="section"><h2>How To Use SFMF4J<a name="How_To_Use_SFMF4J"></a></h2><div class="section"><h3>For Library Architects<a name="For_Library_Architects"></a></h3><p>Developing a file monitoring solution using SFMF4J is pretty simple. You simply need to:</p><ol style="list-style-type: decimal"><li>Define a dependency on <tt>sfmf4j-api</tt>.</li><li>Implement <a href="./sfmf4j-api/apidocs/com/github/sworisbreathing/sfmf4j/api/DirectoryListener.html">DirectoryListener</a>.</li><li>Register the <tt>DirectoryListener</tt> implementation with a <a href="./sfmf4j-api/apidocs/com/github/sworisbreathing/sfmf4j/api/FileMonitorService.html">FileMonitorService</a>.</li></ol><div class="section"><h4>Define a dependency on <tt>sfmf4j-api</tt>.<a name="Define_a_dependency_on_sfmf4j-api."></a></h4><p>When writing code against SFMF4J, you need only add a <a href="./sfmf4j-api/dependency-info.html">compile-time dependency</a> on <tt>sfmf4j-api</tt>. You can (and should) defer the choice of implementation to the application architecture.</p></div><div class="section"><h4>Implement DirectoryListener<a name="Implement_DirectoryListener"></a></h4><p>SFMF4J uses an event/listener paradigm for handling file system changes at the directory level. SFMF4J supports three types of events:</p><dl><dt>File Creation</dt><dd>events are fired when a new file or subdirectory is detected</dd><dt>File Change</dt><dd>events are fired when the contents of a file or subdirectory have changed, or are likely to have changed.</dd><dt>File Deletion</dt><dd>events are fired when a monitored directory no longer contains a subdirectory or file.</dd></dl><p>Sometimes you may only be interested in a subset of these events. For example, you may have a process which monitors a folder on an FTP server where users upload files, so you only really care about new files being added. In such a case, you are encouraged to extend <a href="./sfmf4j-api/apidocs/com/github/sworisbreathing/sfmf4j/api/DirectoryListenerAdapter.html">DirectoryListenerAdapter</a> and override its no-op implementations.</p></div><div class="section"><h4>Register with a FileMonitorService<a name="Register_with_a_FileMonitorService"></a></h4><p>The act of monitoring the file system for changes and notifying interested parties is handled by a <a href="./sfmf4j-api/apidocs/com/github/sworisbreathing/sfmf4j/api/FileMonitorService.html">FileMonitorService</a>. How you obtain a reference to a <tt>FileMonitorService</tt> is up to you, but for your convenience, you can create a pre-configured instance from a <a href="./sfmf4j-api/apidocs/com/github/sworisbreathing/sfmf4j/api/FileMonitorServiceFactory.html">FileMonitorServiceFactory</a>.</p><p>You will need to maintain a reference to your <tt>FileMonitorService</tt> in order to later unregister the listener when you no longer have any interest in file system events.</p></div></div><div class="section"><h3>For Application Architects<a name="For_Application_Architects"></a></h3><p>Deploying an application with file monitoring is easy.</p><ol style="list-style-type: decimal"><li>Choose your implementation</li><li>Obtain a <tt>FileMonitorServiceFactory</tt> and a <tt>FileMonitorService</tt></li><li>Make your <tt>FileMonitorService</tt> available to interested parties.</li></ol><div class="section"><h4>Choose your implementation<a name="Choose_your_implementation"></a></h4><p>Adding an SFMF4J implementation to your application is a simple matter of ensuring the implementation's jar is on the application's classpath (along with its dependencies). For OSGi environments, the implementation bundle needs to be installed in the OSGi container.</p><p>You should give some consideration to which implementation you choose, as each has its own <a href="./implementation-features.html">advantages and drawbacks</a>.</p></div><div class="section"><h4>Obtain a FileMonitorServiceFactory<a name="Obtain_a_FileMonitorServiceFactory"></a></h4><p>In Java 6+ environments, implementations can be loaded via Java SPI (a.k.a. <tt>java.util.ServiceLoader</tt>). Note that when using this method, you must invoke the lifecycle methods <tt>initialize</tt> and <tt>shutdown</tt> yourself.</p><div class="source"><pre class="prettyprint">import com.github.sworisbreathing.sfmf4j.api.FileMonitorServiceFactory;
import java.util.Iterator;
import java.util.ServiceLoader;

static FileMonitorServiceFactory loadFileMonitorServiceFactory() {
    ServiceLoader&lt;FileMonitorServiceFactory&gt; serviceLoader = ServiceLoader.load(
        FileMonitorServiceFactory.class);
    Iterator&lt;FileMonitorServiceFactory&gt; implementationIterator = serviceLoader.iterator();
    if(implementationIterator.hasNext()) {
        return implementationIterator.next();
    }
}

static FileMonitorService newFileMonitorServiceInstance() {
    FileMonitorServiceFactory implementationFactory = loadFileMonitorServiceFactory();
    FileMonitorService results = implementationFactory.createFileMonitorService();
    return results;
}

</pre></div><p>In OSGi environments, implementations are registered as services via Blueprint. Using this approach, you can easily rely on the OSGi container to manage the file monitor service's lifecycle for you, simply by declaring the <tt>init-method</tt> and <tt>destroy-method</tt>.</p><div class="source"><pre class="prettyprint">&lt;reference id=&quot;implementationFactory&quot; interface=&quot;com.github.sworisbreathing.sfmf4j.api.FileMonitorServiceFactory&quot; /&gt;
&lt;bean id=&quot;fileMonitorService&quot; class=&quot;com.github.sworisbreathing.sfmf4j.api.FileMonitorService&quot;
    factory-ref=&quot;implementationFactory&quot; factory-method=&quot;createFileMonitorService&quot;
    init-method=&quot;initialize&quot; destroy-method=&quot;shutdown&quot;/&gt;
</pre></div></div><div class="section"><h4>Supplying a FileMonitorService<a name="Supplying_a_FileMonitorService"></a></h4><p>Once your application has a <tt>FileMonitorService</tt> instance, it must be made available to interested parties. If you are using a dependency injection framework, such as Spring, then this should be fairly easy. Otherwise, you may need to register the service via JNDI or make it available via some other mechanism. This largely depends on how the library code expects to obtain the <tt>FileMonitorService</tt> instance.</p></div></div><div class="section"><h3>Notes On Threading<a name="Notes_On_Threading"></a></h3><p>By default, each instance of <tt>FileMonitorService</tt> runs in its own dedicated thread, from which it detects file change events and invokes <tt>DirectoryListener</tt> callbacks. If this is a concern for you, you have a few options, such as:</p><ul><li>Offloading <tt>DirectoryListener</tt> callbacks to a separate thread. There are various approaches which can be used here. For example, your <tt>DirectoryListener</tt> callbacks can submit tasks to an <a class="externalLink" href="http://http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a> or push the events onto a service bus such as <a class="externalLink" href="http://code.google.com/p/guava-libraries/wiki/EventBusExplained">Guava EventBus</a> or an asynchronous <a class="externalLink" href="http://camel.apache.org/seda.html">Camel route</a>. This can be a good option for library architects.</li><li>Using multiple <tt>FileMonitorService</tt> instances. This is better suited to application architects than library architects, since its effectiveness largely depends on how it is applied to the deployment environment. You might choose to split up the <tt>FileMonitorService</tt> instances based on which file systems or directories are being monitored (i.e. &quot;per-disk&quot; or &quot;per-folder&quot;), or you might split them up based on which system functions they are being used for.</li><li>Using custom <tt>FileMonitorServiceFactory</tt> configurations. This is also better suited for application architects, since it requires knowing which implementation is in use, and how it can be configured.</li></ul></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
              <div class="row span12">Copyright &copy;                    2013
                        <a href="https://github.com/sworisbreathing/">Steven Swor</a>.
            All Rights Reserved.      
                    
                  <li id="publishDate" class="pull-right">Last Published: 2013-03-06</li> 
            </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
  </body>
</html>
